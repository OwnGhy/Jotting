# JS正则实用技巧记录
正则一直是我的弱项，基本的知识看了好几遍，但是当需求来了的时候，往往还是不能正确的使用正则去处理问题，常常都是在网上搜索的答案😢。

为了掌握正则，在这里记录自己平时遇到的一些正则需求，以及使用方法，通过越来越多的使用，希望能真的掌握正则。

另：由于我基础真的不好，所以都写得很基础😢，目的在于能巩固一下。`啰嗦预警~`

## 实际需求类

### 中括号内容及中括号加粗
#### 场景
需求是对系统用户的操作进行记录，后端会将操作描述拼接为'[张三]创建账单[213]'这样的字符串，在前端拿到之后需要进行处理，将中括号及中括号中的内容加粗。

```
text.replace(/\[[^\[\]]*]/g,$0 => {
	return `<span style="color: #1f2331;font-weight: 500;">${$0}</span>`;
})
// "<b>[张三]</b>创建账单<b>[213]</b>"
```
上面的代码可以正确的匹配并得到结果。

解析：

- `\[`：`[`是特殊符号，需要转义
- `[^\[\]]*`:`[^]`表示反向字符集，在反向字符集中添加`\[\]`表示不匹配`[`和`]`，以避免嵌套中括的情况，`*`表示不是`[`和`]`的字符可以出现任意次数
- `]`：表示结尾的匹配，需要注意的是`]`不是特殊字符，可以不用转移，但是在上一步的反向字符集中，为了区分反向字符集的结尾，所以进行了转义

#### 拓展
上面的正则，如果中括号出现嵌套的情况，例如：`[[张三]]创建账单[213]`会替换成`[<b>[张三]</b>创建账单<b>[213]</b>`，只会匹配最内层的中括号，那么如何匹配最外层的中括号呢？

```
text.replace(/\[[^\]]*]*/g,$0 => {
	return `<span style="color: #1f2331;font-weight: 500;">${$0}</span>`;
})
// "<b>[[张三]]</b>创建账单<b>[213]</b>"
```

解析，最大的区别在于下面亮点：
- `[^\]]`：反向字符集中去除了`\[`，以达到可以包括`[`的目的
- `]*`： 尾部的结束可以多个`]`，这样避免了在遇到多个`]`的时候正则匹配提前结束，如果不添加`]]`的情况，那么最后的匹配结果将是`<b>[[张三]</b>]创建账单<b>[213]</b>`，导致遇到第一个中括号提前结束，以致匹配错误

### 获取URL的查询参数
之前获取url的查询参数都是用的第三方的工具，其实要自己匹配获取还是很简单的。

```
// ?name=nancy&id=123
let query = {};
location.search.replace(/([^?&=]+)=([^&]+)/g, ($0, $1, $2) => query[$1] = $2);
console.log(query);  // { name: 'nancy', id: '123' }
```
解析，主要是两个分组和一个`=`：

- `([^?&=]+)`：这个分组用于匹配查询参数的key，`[^?&=]`这个反向字符集中表示，key不能包括`?`、`&`或者`=`，达到去除这三个符号的目的
- `=`：用`=`间隔key和value
- `([^&]+)`：这一个分组和前一个分组差不多，只不过不包括`?`因为后面的value不会出现`?`，只在第一个字符出现

通过replace的方法，将匹配的到key和value赋值到结果query中，目的达到啦✌️。

## 数字类
待续...